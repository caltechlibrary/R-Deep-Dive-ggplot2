---
title: "R Notebook"
output: html_notebook
---

# Setup

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk (green arrow in the top right) or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. This set of commands downlaods, installs and attaches packages we will need for this lesson. If you get a message asking to restart R, click Yes. If you get asked to recompile anything from a source binary, type Yes in the console.

```{r setup}
install.packages("tidyverse")
install.packages("caTools")
install.packages("bitops")
install.packages("ggplot2")
install.packages("PeriodicTable")
library("tidyverse")
library("caTools")
library("bitops")
library("ggplot2")
library("PeriodicTable")
```

We will be working with a dataset about the periodic table. Information and documentation about this dataset can be found here: https://cran.r-project.org/package=PeriodicTable

Run the code chunk below to load this dataset into the R environment.

```{r load_dataset}
data("periodicTable")
```

You should now see "periodicTable" in the Environment tab on the right side of your RStudio window.

# Simple Scatter Plot

There's lots of data that we can play with here. Let's start by making a simple plot of atomic mass versus atomic number to check the integrity of our data. What should this plot look like? Run the code below to generate a graph.

```{r plot_for_data_integrity}
ggplot(data=periodicTable,aes(x=numb,y=mass)) + geom_point()
```

This is an example of the most basic of ggplots. It has three key elements:
1. "data=": the data you are plotting (usually the name of your data frame in your environment)
2. "aes()": these are the aesthetic mappings for the plot - how are we visually representing the data variables. The basic ones used here are:
- what data to plot on the x axis
- what data to plot on the y axis
3. An additional layer (signified by the + symbol) to describe what the plotted data should look like using the geom designation. 

In this case, we are using the periodicTable data frame, and plotting numb on x and mass on y. We are specifiying the data be represented as individual points.

## Exercise 1 - Finding A Pattern

Make a scatter plot of density (y axis) versus atomic mass (x axis). Plot the data as points.
Add a new chunk by clicking the *Insert Chunk* button (top of the window on the toolbar) or by pressing *Cmd+Option+I*.

```{r}
# ggplot(data=periodicTable,aes(x=mass,y=density)) + geom_point()
```


# Exercise 2 - Adding Color

We can see from Exercise 1 the periodicity behing the periodic table :) We can use color to further pick out the changes from the table by coloring the points according to what period they are in. We can do this by specifying an additional aesthetic ("aes()").

Recreate your graph from above, but add the following to the main plot aesthetics, after the x and y specification:
color=period

Add a new chunk by clicking the *Insert Chunk* button (top of the window on the toolbar) or by pressing *Cmd+Option+I*.

```{r}
# ggplot(data=periodicTable,aes(x=mass,y=density,color=period)) + geom_point()
```

This shows us the variation, but it would be nicer to have the periods as discrete colors and not a gradient. The reason it plotted period as a gradient is because in the data frame, period is an integer. We want period to be a categorical value, or a factor, in this case. This can be done by changing color=period to color=factor(period). 

Make this modification and replot. (Watch your parenthesis!)

Add a new chunk by clicking the *Insert Chunk* button (top of the window on the toolbar) or by pressing *Cmd+Option+I*.

```{r}
# ggplot(data=periodicTable,aes(x=mass,y=density,color=factor(period))) + geom_point()
```

Alternately you can change the data type for that column directly in the data set with:

periodicTable$period <- factor(periodicTable$period)

However, if you're not sure you want to permanently change a data type, just modify it in the ggplot expression.

# Exercise 3 - Adding a Fit

Let's go back to our original graph of mass versus numb:

```{r plot_for_data_integrity_2}
ggplot(data=periodicTable,aes(x=numb,y=mass)) + geom_point()
```

We want to add a linear fit to this graph. We can do this by adding a layer of geom_smooth() and specifying the model we want to model with. 


```{r layered_geoms}
# ggplot(data=periodicTable,aes(x=numb,y=mass)) + geom_point() + geom_smooth(method="lm")
```

# Exercise 4 - Other Types of Visualizations

We have a number of different variables we can look at. Let's make a bar chart to count how many elements there are of each type. 


```{r element_type_histogram}
ggplot(data=periodicTable) + geom_bar(mapping=aes(x=type))
```

You can pop out the graph into a separate window to de-smush the x-axis by clicking the small square icon (next to the arrows) in the top right of the graph window.

# Customizing Title, Labels, Axes, etc.

# Exercise

Create a bar plot for phase.

# References

ggplot2: Elegant Graphics for Data Analysis
R for Data Science, Chapter 3: Data Visualization - http://r4ds.had.co.nz/data-visualisation.html




When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.